<!-- Copilot instructions for the SiteJao repository -->
# Copilot instructions — SiteJao

Quick orientation (what matters most):
- Big picture: this repo holds a static frontend site (Sites-main/Site-Barbearia-Jão/Front), SQL seeds/scripts for Supabase, and exported n8n flows that act as the booking/assistant layer. The frontend reads runtime config from `config.js` (generated by `build-config.js`) and queries Supabase for `servicos` and `config_barbearia`.

- Key integration points:
  - Frontend: `Sites-main/Site-Barbearia-Jão/Front/index.html`, `script.js`, `config.template.js`, `build-config.js`.
  - DB: SQL seeds are under `Banco de Dados/` and `Site-Barbearia-Jão/Back` (look for `setup_banco_supabase.sql` / `BANCO_COMPLETO_SUPABASE.sql`).
  - Automation: n8n flows `Bot-BarbeariaJao.json` and `Site-Barbearia-Jão/Back/Bot_Atendente_Agendamento.json` — these should be treated as importable flows.

- Local dev & build commands (exact):
  - Serve the front statically:
    - PowerShell: `cd "Sites-main/Site-Barbearia-Jão/Front"; npx http-server -c-1 .`
    - Python: `python -m http.server 5500`
  - Build/generate runtime config (Vercel also runs this):
    - `node build-config.js` (or `npm run build` from `Front` where `package.json` contains the script).

- Important runtime conventions and safety rules:
  - The frontend must use the Supabase *anon* key only. Never expose `service_role` in frontend code or committed files.
  - `config.js` is generated at build time from `config.template.js` by `build-config.js`. Do not edit `config.js` manually — edit the template.
  - When adding or editing prompts for the assistant, prefer injecting DB context (JSON) from n8n rather than hardcoding prices/hours into the prompt.

- Data flow patterns to follow when coding agents:
  - Query `servicos` + `config_barbearia` from Supabase and pass them as a small JSON context object to any AI prompt. e.g. {
    "servicos": [{"id":1,"nome":"Corte","preco":30,"duracao":30}],
    "config": {"abertura":"09:00","fechamento":"18:00"}
  }
  - Validate availability server-side (or in n8n) before confirming reservations — the frontend or AI may suggest times but the DB is authoritative.

- Files to inspect when making changes or triaging bugs:
  - `Sites-main/Site-Barbearia-Jão/Front/script.js` — frontend logic that fetches and displays services.
  - `Sites-main/Site-Barbearia-Jão/Front/build-config.js` & `config.template.js` — how runtime config is built.
  - `Banco de Dados/BANCO_COMPLETO_SUPABASE.sql` (or `Site-Barbearia-Jão/Back/setup_banco_supabase.sql`) — schema and seed data.
  - `Bot-BarbeariaJao.json` and `Site-Barbearia-Jão/Back/Bot_Atendente_Agendamento.json` — n8n flows controlling assistant behavior.

- Helpful examples for patch suggestions (copyable):
  - To add a local dev instruction in README: show exact commands above and note the `Front` root for Vercel.
  - To change how the AI is called from n8n: add a Pre-node that queries Supabase and attaches `context.servicos` and `context.config` to the payload.

- What NOT to change / watch out for:
  - Do not commit `config.js` or any secrets. There is a template and build step specifically to avoid this.
  - Avoid changing the structure of the exported n8n JSON unless you understand node IDs — small edits may break imports.

- If something is missing:
  - Ask for the Supabase project URL and whether seeds were already applied.
  - Ask which n8n instance/environment is the source of truth for flows.

If any part of the environment is unclear (e.g., missing DB seeds, Supabase project URL, or which n8n instance is used), ask for those specifics before making behaviour-changing edits.
